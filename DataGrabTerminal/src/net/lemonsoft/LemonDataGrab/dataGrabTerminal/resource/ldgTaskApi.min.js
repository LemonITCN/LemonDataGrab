/*! LemonDataGrabTaskJavaScriptAPI 16-08-2016 

 Lemonsoft Technology */

<<<<<<< HEAD
function Task(){}function DataGrab(a){var a=a;this.executeJS=function(b){return window.grabber.executeJS(a,b)},this.getDomAttribute=function(a,b){return this.executeJS("document.querySelector('"+a+"').getAttribute('"+b+"')")},this.getDomProperty=function(a,b){return this.executeJS("document.querySelector('"+a+"')."+b)},this.getInnerHTML=function(a){try{var b=this.getDomProperty(a,"innerHTML");return Log.success("根据脚本命令获取指定元素的innerHTML成功"),b}catch(c){return Log.warn("获取指定元素的innerHTML失败:"+c),null}},this.getOuterHTML=function(a){try{var b=this.getDomProperty(a,"outerHTML");return Log.success("根据脚本命令获取指定元素的outerHTML成功"),b}catch(c){return Log.warn("获取指定元素的outerHTML失败:"+c),null}},this.getInnerText=function(a){try{var b=this.getDomProperty(a,"innerText");return Log.success("根据脚本命令获取指定元素的innerText成功"),b}catch(c){return Log.warn("获取指定元素的innerText失败:"+c),null}},this.getURL=function(){try{var a=this.executeJS("location.href");return Log.success("根据脚本命令获取当前采集数据的界面的URL成功"),a}catch(b){return Log.warn("获取当前采集数据的界面的URL失败:"+b),null}},this.getImgDomURL=function(a){try{var b=this.getDomProperty(a,"src");return Log.success("根据脚本命令获取指定图片Dom元素的图片URL成功"),b}catch(c){return Log.warn("获取指定图片Dom元素的图片URL失败:"+c),null}},this.getADomURL=function(a){try{var b=this.getDomProperty(a,"href");return Log.success("根据脚本命令获取指定A标记的的链接URL成功"),b}catch(c){return Log.warn("获取指定A标记的的链接URL失败:"+c),null}}}function Grabber(){var a=Util.createUUID();this.getIdentity=function(){return a},this.dataGrab=new DataGrab(a),this.operate=new Operate(a),this.show=function(){Log.info("showshow~"),window.grabber.show(a)},this.hide=function(){window.grabber.hide(a)},this["delete"]=function(){window.grabber["delete"](a),a=""},window.grabber.create(a),this.show()}function Operate(a){var b=a;this.executeJS=function(a){return window.grabber.executeJS(b,a)},this.loadURL=function(a,c,d,e){Log.info("开始加载URL:"+a),console.log("START LOAD URL"+a+" - "+b),this.executeJS("location.href="+a),console.log("LOAD URL END!!!!"+a)},this.setDomAttribute=function(a,b,c){this.executeJS("document.querySelector('"+a+"').setAttribute('"+b+"' , '"+c+"')")},this.setDomProperty=function(a,b,c){this.executeJS("document.querySelector('"+a+"')."+b+" = '"+c+"'")},this.invokeDomFunction=function(a,b,c){this.executeJS("document.querySelector('"+a+"')."+b+"("+c.join(",")+")")},this.invokeDomMouseAction=function(a,b){this.executeJS(String.format("window.eval(\"var event = document.createEvent('MouseEvents');event.initMouseEvent('%s',true,true,window,0,0,0,0,0,false,false,false,false,0,null);document.querySelector('%s').dispatchEvent(event);\")",b,a))},this.fillInputText=function(a,b){this.setDomAttribute(a,"value",b),Log.success("在指定的Input文本控件中填写值成功")},this.selectItem=function(a,b){this.setDomProperty("selectedIndex",b),Log.success("选择指定的下拉菜单的下拉项目成功")},this.checkedItem=function(a,b){this.setDomProperty("checked",b?"checked":""),Log.success("选中指定radio或checkbox成功")},this.submitForm=function(a){this.invokeDomFunction(a,"submit",[]),Log.success("触发提交指定的表单成功")},this.sleep=function(a){Log.info("休眠"+a+" 开始"),Util.sleep(a),Log.info("休眠"+a+" 结束")},this.scrollToPosition=function(a,b){this.executeJS("window.scrollTo("+a+" , "+b+")"),Log.success("让当前页面滚动到指定的位置成功")},this.clickDom=function(a){this.invokeDomMouseAction(a,"click"),Log.success("点击指定的Dom元素成功")},this.mouseoverDom=function(a){this.invokeDomMouseAction(a,"mouseover"),Log.success("触发指定Dom元素的鼠标悬浮事件成功")}}function Log(){}function LogModel(a,b,c){this.time=a,this.type=b,this.message=c}function ErrorModel(a){this.log=a}function ResultModel(){this.data={},this.log=[]}function TaskModel(){this.tid="",this.name="",this.fingerprint="",this.description="",this.createTime="",this.publishTime="",this.distributeRepeatInterval="",this.distributeRepeatCount="",this.distributedNumber="",this.executeScript="",this.state="",this.theTop="",this.expired=""}function Task(a){var a=a;this.sendError=function(b){$.ajax({url:"",method:"post",type:"json",data:{taskFingerprint:a.fingerprint,log:b.log}})},this.sendResult=function(b){$.ajax({url:"",method:"post",type:"json",data:{fingerprint:a.fingerprint,data:b.data,log:b.log}})}}function TaskList(){}function Terminal(){}function Util(){}Task.identity="",window.onload=function(){Terminal.success("┏━━━━━━━━━━━━━━━━━━━━━━━┓"),Terminal.success("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;欢迎使用LemonDataGrab分布式数据采集器"),Terminal.success("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright （c） 2016&nbsp;&nbsp;&nbsp;1em0nsOft "),Terminal.success("┗━━━━━━━━━━━━━━━━━━━━━━━┛"),Terminal.info("Lemon Distributed data acquisition system start success!")},Log.logs=[],Log.getAllLogs=function(){return this.logs},Log.removeAllLogs=function(){this.logs=[]};const LOG_TYPE_SUCCESS=0,LOG_TYPE_ERROR=1,LOG_TYPE_WARN=2,LOG_TYPE_INFO=3,LOG_TYPE_MSG=4;Log.success=function(a){this.message(LOG_TYPE_SUCCESS,a)},Log.error=function(a){this.message(LOG_TYPE_ERROR,a)},Log.warn=function(a){this.message(LOG_TYPE_WARN,a)},Log.info=function(a){this.message(LOG_TYPE_INFO,a)},Log.msg=function(a){this.message(LOG_TYPE_MSG,a)},Log.message=function(a,b){switch(a){case LOG_TYPE_SUCCESS:Terminal.success(b);break;case LOG_TYPE_ERROR:Terminal.error(b);break;case LOG_TYPE_WARN:Terminal.warn(b);break;case LOG_TYPE_INFO:Terminal.info(b);break;case LOG_TYPE_MSG:Terminal.msg(b)}var c=new LogModel(Util.getUnixTimeStamp(),a,b);this.logs.push(c)},TaskList.list=new Array,TaskList.addTask=function(a){TaskList.list.push(a)},TaskList.removeTaskByIndex=function(a){TaskList.list.remove(a)},TaskList.updateTaskByIndex=function(a,b){TaskList.list[a]=b},TaskList.setSuccessByIndex=function(a){TaskList.list[a].state=TASK_STATE_SUCCESS},TaskList.setErrorByIndex=function(a){TaskList.list[a].state=TASK_STATE_ERROR},TaskList.setWaitingByIndex=function(a){TaskList.list[a].state=TASK_STATE_WAITING},TaskList.setRunningByIndex=function(a){TaskList.list[a].state=TASK_STATE_RUNNING},TaskList.taskCount=function(){return TaskList.list.length},TaskList.getByIndex=function(a){return TaskList.list[a]},TaskList.refreshDisplay=function(){for(var a=["active","info","success","danger","warning"],b=["待运行","执行中","成功","失败","有错误"],c="",d=0;d<TaskList.taskCount();d++){var e=TaskList.getByIndex(d);console.log("TASK JSON:"+e),c+="<tr class='"+a[e.state]+"'><td>"+(d+1)+"</td><td>"+e.name+"</td><td>"+b[e.state]+"</td></tr>"}document.getElementById("taskListContentBody").innerHTML=c},Terminal.id=0,Terminal.info=function(a){Terminal.message("info",a,"提示")},Terminal.warn=function(a){Terminal.message("warning",a,"警告")},Terminal.error=function(a){Terminal.message("danger",a,"错误")},Terminal.success=function(a){Terminal.message("success",a,"成功")},Terminal.msg=function(a){Terminal.message("active",a,"消息")},Terminal.message=function(a,b,c){var d=document.getElementById("terminalPanelContentBody"),e=document.createElement("tr");e.setAttribute("class",a),e.innerHTML="<td>"+ ++Terminal.id+"</td><td>"+b+"</td><td>"+c+"</td>",d.appendChild(e),document.getElementsByClassName("terminalPanel")[0].scrollTop=40*d.children.length},Util.createUUID=function(){for(var a=[],b="0123456789abcdef",c=0;c<36;c++)a[c]=b.substr(Math.floor(16*Math.random()),1);a[14]="4",a[19]=b.substr(3&a[19]|8,1),a[8]=a[13]=a[18]=a[23]="-";var d=a.join("");return d},Util.getUnixTimeStamp=function(){return Math.round((new Date).getTime()/1e3)},Util.sleep=function(a){for(var b=new Date,c=b.getTime()+numberMillis;;)if(b=new Date,b.getTime()>c)return};
=======
function Task(){}function DataGrab(a){var a=a;this.executeJS=function(b){return window.grabber.executeJS(a,b)},this.getDomAttribute=function(a,b){return this.executeJS("document.querySelector('"+a+"').getAttribute('"+b+"')")},this.getDomProperty=function(a,b){return this.executeJS("document.querySelector('"+a+"')."+b)},this.getInnerHTML=function(a){try{var b=this.getDomProperty(a,"innerHTML");return Log.success("根据脚本命令获取指定元素的innerHTML成功"),b}catch(c){return Log.warn("获取指定元素的innerHTML失败:"+c),null}},this.getOuterHTML=function(a){try{var b=this.getDomProperty(a,"outerHTML");return Log.success("根据脚本命令获取指定元素的outerHTML成功"),b}catch(c){return Log.warn("获取指定元素的outerHTML失败:"+c),null}},this.getInnerText=function(a){try{var b=this.getDomProperty(a,"innerText");return Log.success("根据脚本命令获取指定元素的innerText成功"),b}catch(c){return Log.warn("获取指定元素的innerText失败:"+c),null}},this.getURL=function(){try{var a=this.executeJS("location.href");return Log.success("根据脚本命令获取当前采集数据的界面的URL成功"),a}catch(b){return Log.warn("获取当前采集数据的界面的URL失败:"+b),null}},this.getImgDomURL=function(a){try{var b=this.getDomProperty(a,"src");return Log.success("根据脚本命令获取指定图片Dom元素的图片URL成功"),b}catch(c){return Log.warn("获取指定图片Dom元素的图片URL失败:"+c),null}},this.getADomURL=function(a){try{var b=this.getDomProperty(a,"href");return Log.success("根据脚本命令获取指定A标记的的链接URL成功"),b}catch(c){return Log.warn("获取指定A标记的的链接URL失败:"+c),null}}}function Grabber(){var a=Util.createUUID();this.getIdentity=function(){return a},this.dataGrab=new DataGrab(a),this.operate=new Operate(a),this.show=function(){Log.info("showshow~"),window.grabber.show(a)},this.hide=function(){window.grabber.hide(a)},this["delete"]=function(){window.grabber["delete"](a),a=""},window.grabber.create(a),this.show()}function Operate(a){var b=a;this.executeJS=function(a){return window.grabber.executeJS(b,a)},this.loadURL=function(a,c,d,e){Log.info("开始加载URL:"+a),console.log("START LOAD URL"+a+" - "+b),window.grabber.loadURL(b,a,c,d,e),console.log("LOAD URL END!!!!"+a)},this.setDomAttribute=function(a,b,c){this.executeJS("document.querySelector('"+a+"').setAttribute('"+b+"' , '"+c+"')")},this.setDomProperty=function(a,b,c){this.executeJS("document.querySelector('"+a+"')."+b+" = '"+c+"'")},this.invokeDomFunction=function(a,b,c){this.executeJS("document.querySelector('"+a+"')."+b+"("+c.join(",")+")")},this.invokeDomMouseAction=function(a,b){this.executeJS(String.format("window.eval(\"var event = document.createEvent('MouseEvents');event.initMouseEvent('%s',true,true,window,0,0,0,0,0,false,false,false,false,0,null);document.querySelector('%s').dispatchEvent(event);\")",b,a))},this.fillInputText=function(a,b){this.setDomAttribute(a,"value",b),Log.success("在指定的Input文本控件中填写值成功")},this.selectItem=function(a,b){this.setDomProperty("selectedIndex",b),Log.success("选择指定的下拉菜单的下拉项目成功")},this.checkedItem=function(a,b){this.setDomProperty("checked",b?"checked":""),Log.success("选中指定radio或checkbox成功")},this.submitForm=function(a){this.invokeDomFunction(a,"submit",[]),Log.success("触发提交指定的表单成功")},this.sleep=function(a){Log.info("休眠"+a+" 开始"),Util.sleep(a),Log.info("休眠"+a+" 结束")},this.scrollToPosition=function(a,b){this.executeJS("window.scrollTo("+a+" , "+b+")"),Log.success("让当前页面滚动到指定的位置成功")},this.clickDom=function(a){this.invokeDomMouseAction(a,"click"),Log.success("点击指定的Dom元素成功")},this.mouseoverDom=function(a){this.invokeDomMouseAction(a,"mouseover"),Log.success("触发指定Dom元素的鼠标悬浮事件成功")}}function Log(){}function LogModel(a,b,c){this.time=a,this.type=b,this.message=c}function ErrorModel(a){this.log=a}function ResultModel(){this.data={},this.log=[]}function TaskModel(){this.tid="",this.name="",this.fingerprint="",this.description="",this.createTime="",this.publishTime="",this.distributeRepeatInterval="",this.distributeRepeatCount="",this.distributedNumber="",this.executeScript="",this.state="",this.theTop="",this.expired=""}function Task(a){var a=a;this.sendError=function(b){$.ajax({url:"",method:"post",type:"json",data:{taskFingerprint:a.fingerprint,log:b.log}})},this.sendResult=function(b){$.ajax({url:"",method:"post",type:"json",data:{fingerprint:a.fingerprint,data:b.data,log:b.log}})}}function TaskList(){}function Terminal(){}function Util(){}Task.identity="",window.onload=function(){Terminal.success("┏━━━━━━━━━━━━━━━━━━━━━━━┓"),Terminal.success("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;欢迎使用LemonDataGrab分布式数据采集器"),Terminal.success("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Copyright （c） 2016&nbsp;&nbsp;&nbsp;1em0nsOft "),Terminal.success("┗━━━━━━━━━━━━━━━━━━━━━━━┛"),Terminal.info("Lemon Distributed data acquisition system start success!")},Log.logs=[],Log.getAllLogs=function(){return this.logs},Log.removeAllLogs=function(){this.logs=[]};const LOG_TYPE_SUCCESS=0,LOG_TYPE_ERROR=1,LOG_TYPE_WARN=2,LOG_TYPE_INFO=3,LOG_TYPE_MSG=4;Log.success=function(a){this.message(LOG_TYPE_SUCCESS,a)},Log.error=function(a){this.message(LOG_TYPE_ERROR,a)},Log.warn=function(a){this.message(LOG_TYPE_WARN,a)},Log.info=function(a){this.message(LOG_TYPE_INFO,a)},Log.msg=function(a){this.message(LOG_TYPE_MSG,a)},Log.message=function(a,b){switch(a){case LOG_TYPE_SUCCESS:Terminal.success(b);break;case LOG_TYPE_ERROR:Terminal.error(b);break;case LOG_TYPE_WARN:Terminal.warn(b);break;case LOG_TYPE_INFO:Terminal.info(b);break;case LOG_TYPE_MSG:Terminal.msg(b)}var c=new LogModel(Util.getUnixTimeStamp(),a,b);this.logs.push(c)},TaskList.list=new Array,TaskList.addTask=function(a){TaskList.list.push(a)},TaskList.removeTaskByIndex=function(a){TaskList.list.remove(a)},TaskList.updateTaskByIndex=function(a,b){TaskList.list[a]=b},TaskList.setSuccessByIndex=function(a){TaskList.list[a].state=TASK_STATE_SUCCESS},TaskList.setErrorByIndex=function(a){TaskList.list[a].state=TASK_STATE_ERROR},TaskList.setWaitingByIndex=function(a){TaskList.list[a].state=TASK_STATE_WAITING},TaskList.setRunningByIndex=function(a){TaskList.list[a].state=TASK_STATE_RUNNING},TaskList.taskCount=function(){return TaskList.list.length},TaskList.getByIndex=function(a){return TaskList.list[a]},TaskList.refreshDisplay=function(){for(var a=["active","info","success","danger","warning"],b=["待运行","执行中","成功","失败","有错误"],c="",d=0;d<TaskList.taskCount();d++){var e=TaskList.getByIndex(d);console.log("TASK JSON:"+e),c+="<tr class='"+a[e.state]+"'><td>"+(d+1)+"</td><td>"+e.name+"</td><td>"+b[e.state]+"</td></tr>"}document.getElementById("taskListContentBody").innerHTML=c},Terminal.id=0,Terminal.info=function(a){Terminal.message("info",a,"提示")},Terminal.warn=function(a){Terminal.message("warning",a,"警告")},Terminal.error=function(a){Terminal.message("danger",a,"错误")},Terminal.success=function(a){Terminal.message("success",a,"成功")},Terminal.msg=function(a){Terminal.message("active",a,"消息")},Terminal.message=function(a,b,c){var d=document.getElementById("terminalPanelContentBody"),e=document.createElement("tr");e.setAttribute("class",a),e.innerHTML="<td>"+ ++Terminal.id+"</td><td>"+b+"</td><td>"+c+"</td>",d.appendChild(e),document.getElementsByClassName("terminalPanel")[0].scrollTop=40*d.children.length},Util.createUUID=function(){for(var a=[],b="0123456789abcdef",c=0;36>c;c++)a[c]=b.substr(Math.floor(16*Math.random()),1);a[14]="4",a[19]=b.substr(3&a[19]|8,1),a[8]=a[13]=a[18]=a[23]="-";var d=a.join("");return d},Util.getUnixTimeStamp=function(){return Math.round((new Date).getTime()/1e3)},Util.sleep=function(a){for(var b=new Date,c=b.getTime()+a;;)if(b=new Date,b.getTime()>c)return};
>>>>>>> ee6725a476cbcfcdea7f70e79f86138c40ef2ba5
